import os

from cleo import Command
import utils.consolidate_media as CMedia


class CopyCommand(Command):
    """
    Executes a Reverse Proxy Command

    copy
    """

    def handle(self):
        clips = [
            "C1062",
            "C0838",
            "C1096",
            "C0521",
            "C1008",
            "C1076",
            "C0859",
            "C1101",
            "C1091",
            "C0715",
            "C0851",
            "C0481",
            "C0940",
            "C0865",
            "C0427",
            "C0434",
            "C1194",
            "C0925",
            "C0926",
            "C0836",
            "C0776",
            "C1016",
            "C0553",
            "C0590",
            "C0916",
            "C0956",
            "C0572",
            "C0667",
            "C0436",
            "C0790",
            "C1034",
            "C0858",
            "C0931",
            "C0484",
            "C1196",
            "C1227",
            "C0979",
            "C1100",
            "C0463",
            "C0496",
            "C1168",
            "C1043",
            "C1184",
            "C1199",
            "C1238",
            "C0734",
            "C0938",
            "C1209",
            "C0537",
            "C0669",
            "C1045",
            "C0867",
            "C0765",
            "C0789",
            "C1205",
            "C0966",
            "C0764",
            "C0449",
            "C1202",
            "C1218",
            "C0965",
            "C0769",
            "C0454",
            "C0470",
            "C0476",
            "C0727",
            "C0747",
            "C0967",
            "C0832",
            "C1082",
            "C1128",
            "C0539",
            "C0413",
            "C0638",
            "C0993",
            "C1090",
            "C0862",
            "C0932",
            "C0739",
            "C0743",
            "C0996",
            "C1106",
            "C0791",
            "C1031",
            "C1183",
            "C0983",
            "C0847",
            "C0714",
            "C0834",
            "C0726",
            "C0787",
            "C1047",
            "C1166",
            "C0746",
            "C1046",
            "C0422",
            "C0731",
            "C0611",
            "C0617",
            "C1212",
            "C0977",
            "C0995",
            "C0444",
            "C1201",
            "C0927",
            "C1108",
            "C1190",
            "C1129",
            "C0558",
            "C0616",
            "C0415",
            "C1165",
            "C0750",
            "C0784",
            "C1028",
            "C0588",
            "C0433",
            "C1203",
            "C0822",
            "C1119",
            "C1123",
            "C1170",
            "C0600",
            "C1220",
            "C1006",
            "C0491",
            "C1033",
            "C1069",
            "C0706",
            "C0935",
            "C0548",
            "C0564",
            "C1169",
            "C1191",
            "C0999",
            "C1074",
            "C1115",
            "C0448",
            "C1234",
            "C0930",
            "C0846",
            "C0870",
            "C0580",
            "C0435",
            "C1178",
            "C0961",
            "C0760",
            "C0578",
            "C0816",
            "C0549",
            "C0423",
            "C1211",
            "C0929",
            "C0446",
            "C0477",
            "C1207",
            "C0783",
            "C0857",
            "C1129",
            "C0445",
            "C0773",
            "C1088",
            "C0565",
            "C0583",
            "C0928",
            "C0781",
            "C1022",
            "C0860",
            "C1000",
            "C0472",
            "C1208",
            "C0725",
            "C0733",
            "C0808",
            "C1066",
            "C0475",
            "C1181",
            "C0468",
            "C0474",
            "C1013",
            "C0608",
            "C1182",
            "C0738",
            "C0825",
            "C0458",
            "C0485",
            "C1200",
            "C0655",
            "C0659",
            "C0478",
            "C1223",
            "C0730",
            "C0775",
            "C0852",
            "C0766",
            "C0814",
            "C1048",
            "C1174",
            "C1219",
            "C0774",
            "C0576",
            "C1171",
            "C0990",
            "C0827",
            "C0440",
            "C0672",
            "C0547",
            "C1059",
            "C0556",
            "C0577",
            "C1186",
            "C0997",
            "C0411",
            "C0490"
        ]

        dest = ""
        search_dirs = [

        ]
        bad_exts = ['jpg', 'jpeg']
        for _dir in search_dirs:
            for root, dirs, files in os.walk(_dir):
                # found = [f for f in files if [c for c in clips if c in files] and "proxy" not in f]
                if files:
                    for f in files:
                        try:
                            name_no_ext, ext = f.split(".")
                            found = [x for x in clips if x.lower() == name_no_ext.lower()
                                     and "proxy" not in name_no_ext.lower()
                                     and ext.lower() not in bad_exts]

                            if found:
                                src_file = os.path.join(root, f)
                                dest_file = os.path.join(dest, f)
                                print("File Found: " + src_file)
                                if not os.path.exists(dest_file):
                                    CMedia.copy_media(src_file, dest_file)

                        except Exception as e:
                            print("ERR: " + str(e))
